<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#007AFF">
    <title>Â∞èÂ≠¶Ëã±ËØ≠ÁåúËØçÊ∏∏Êàè</title>
    <style>
        :root {
            --ios-blue: #007AFF;
            --ios-gray: #8E8E93;
            --ios-light-gray: #F2F2F7;
            --ios-dark-gray: #1C1C1E;
            --ios-green: #34C759;
            --ios-red: #FF3B30;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--ios-light-gray);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            color: var(--ios-dark-gray);
        }

        .container {
            max-width: 100%;
            width: 100%;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 15px;
            margin-top: 10px;
        }

        h1 {
            color: var(--ios-dark-gray);
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: 600;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .mode-btn {
            padding: 10px 20px;
            font-size: 14px;
        }

        .grade-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .grade-btn {
            padding: 10px 5px;
            font-size: 14px;
        }

        .game-area {
            text-align: center;
            padding: 0 10px;
        }

        .word-display {
            font-size: 20px;
            margin: 15px 0;
        }

        .phonetic {
            font-size: 14px;
            margin-bottom: 8px;
        }

        .example {
            font-size: 14px;
            margin: 10px 0;
            padding: 12px;
        }

        .input-mode-container {
            margin: 15px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .hint-section {
            width: 100%;
            max-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .hint-letters {
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap: 5px;
            width: 100%;
            overflow-x: auto;
            padding: 5px 0;
        }

        .hint-letter {
            min-width: 30px;
            width: 30px;
            height: 40px;
            border: 2px solid var(--ios-gray);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 500;
            background: var(--ios-light-gray);
            flex-shrink: 0;
        }

        .hint-letter.revealed {
            border-color: var(--ios-blue);
            color: var(--ios-blue);
            background: white;
        }

        .hint-letters-container {
            display: flex;
            flex-direction: row;
            gap: 5px;
        }

        .input-section {
            width: 100%;
            max-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--ios-gray);
            border-radius: 10px;
            font-size: 16px;
            text-align: center;
            background: var(--ios-light-gray);
        }

        .button-group {
            display: flex;
            gap: 10px;
            width: 100%;
            justify-content: center;
        }

        .submit-btn, .show-answer-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn {
            background: var(--ios-blue);
            color: white;
        }

        .show-answer-btn {
            background: var(--ios-gray);
            color: white;
        }

        .answer-display {
            font-size: 14px;
            color: var(--ios-blue);
            font-weight: 500;
            margin-top: 5px;
            display: none;
        }

        .options-container {
            grid-template-columns: 1fr;
            gap: 8px;
            margin: 15px 0;
        }

        .option-btn {
            padding: 12px;
            font-size: 14px;
        }

        .result {
            margin: 10px 0;
            font-size: 14px;
            padding: 8px;
        }

        .score {
            margin: 10px 0;
            font-size: 16px;
        }

        .instructions {
            margin-top: 15px;
            padding: 12px;
        }

        .instructions h3 {
            font-size: 14px;
            margin-bottom: 8px;
        }

        .instructions p {
            font-size: 12px;
            margin-bottom: 4px;
        }

        .speak-btn {
            background: var(--ios-blue);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }

        .speak-btn:hover {
            background: #0056b3;
        }

        .speak-btn:active {
            transform: scale(0.95);
        }

        .speak-btn i {
            font-size: 16px;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            .title {
                font-size: 20px;
                margin-bottom: 20px;
            }

            .grade-btn, .submit-btn, .show-answer-btn, .option-btn {
                padding: 10px;
                font-size: 14px;
            }

            .word-display {
                font-size: 20px;
            }

            .phonetic, .example {
                font-size: 14px;
            }
        }

        /* ÊöóËâ≤Ê®°ÂºèÊîØÊåÅ */
        @media (prefers-color-scheme: dark) {
            body {
                background-color: #000000;
                color: #FFFFFF;
            }

            .title {
                color: #FFFFFF;
            }

            .grade-btn, .input-field {
                background-color: #1C1C1E;
                border-color: #38383A;
                color: #FFFFFF;
            }

            .game-area {
                background-color: #1C1C1E;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            }

            .word-display, .example {
                color: #FFFFFF;
            }

            .phonetic {
                color: #8E8E93;
            }

            .submit-btn, .show-answer-btn {
                background-color: #38383A;
                color: #FFFFFF;
            }

            .option-btn {
                background-color: #1C1C1E;
                border-color: #38383A;
                color: #FFFFFF;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Â∞èÂ≠¶Ëã±ËØ≠ÁåúËØçÊ∏∏Êàè</h1>
        
        <div class="mode-selector">
            <button class="mode-btn" data-mode="input">ËæìÂÖ•Ê®°Âºè</button>
            <button class="mode-btn" data-mode="choice">ÈÄâÊã©È¢òÊ®°Âºè</button>
        </div>

        <div class="grade-selector">
            <button class="grade-btn" data-grade="1">‰∏ÄÂπ¥Á∫ß</button>
            <button class="grade-btn" data-grade="2">‰∫åÂπ¥Á∫ß</button>
            <button class="grade-btn" data-grade="3">‰∏âÂπ¥Á∫ß</button>
            <button class="grade-btn" data-grade="4">ÂõõÂπ¥Á∫ß</button>
            <button class="grade-btn" data-grade="5">‰∫îÂπ¥Á∫ß</button>
            <button class="grade-btn" data-grade="6">ÂÖ≠Âπ¥Á∫ß</button>
        </div>

        <div class="game-area">
            <div class="word-display">
                <div class="word"></div>
                <button class="speak-btn">
                    <i>üîä</i> ÂèëÈü≥
                </button>
            </div>
            <div class="phonetic"></div>
            <div class="example"></div>
            <div class="input-mode-container">
                <div class="hint-section">
                    <div class="hint-letters">
                        <div class="hint-letters-container"></div>
                    </div>
                </div>
                <div class="input-section">
                    <input type="text" id="answer-input" placeholder="ËØ∑ËæìÂÖ•Á≠îÊ°à">
                    <div class="button-group">
                        <button class="submit-btn">Êèê‰∫§</button>
                        <button class="show-answer-btn">ÊòæÁ§∫Á≠îÊ°à</button>
                    </div>
                    <div class="answer-display"></div>
                </div>
            </div>
            <div class="options-container" style="display: none;">
                <button class="option-btn" data-option="1"></button>
                <button class="option-btn" data-option="2"></button>
                <button class="option-btn" data-option="3"></button>
                <button class="option-btn" data-option="4"></button>
            </div>
            <div class="result"></div>
            <div class="score">ÂæóÂàÜ: <span id="score">0</span></div>
        </div>

        <div class="instructions">
            <h3>Ê∏∏ÊàèËØ¥ÊòéÔºö</h3>
            <p>1. ÈÄâÊã©Âπ¥Á∫ßÂíåÊ∏∏ÊàèÊ®°ÂºèÔºàËæìÂÖ•Ê®°Âºè/ÈÄâÊã©È¢òÊ®°ÂºèÔºâ</p>
            <p>2. ËæìÂÖ•Ê®°ÂºèÔºöÊ†πÊçÆ‰∏≠ÊñáÊÑèÊÄùËæìÂÖ•Ëã±ÊñáÂçïËØçÔºå‰ºöÊòæÁ§∫ÈÉ®ÂàÜÂ≠óÊØçÊèêÁ§∫</p>
            <p>3. ÈÄâÊã©È¢òÊ®°ÂºèÔºö‰ªéÂõõ‰∏™ÈÄâÈ°π‰∏≠ÈÄâÊã©Ê≠£Á°ÆÁöÑËã±ÊñáÂçïËØçÂ°´Á©∫</p>
            <p>4. Á≠îÂØπ‰∏ÄÈ¢òÂæó10ÂàÜÔºåÁ≠îÈîôÂèØ‰ª•ÈáçËØï</p>
            <p>5. ÊØè‰∏™ÂçïËØçÈÉΩÈÖçÊúâÈü≥Ê†áÂíå‰æãÂè•ÔºåÂ∏ÆÂä©Â≠¶‰π†</p>
        </div>
    </div>

    <script>
        // ‰ªélocalStorageÂä†ËΩΩÂØºÂÖ•ÁöÑÊï∞ÊçÆ
        const wordDatabase = JSON.parse(localStorage.getItem('wordDatabase')) || {
            // ÈªòËÆ§È¢òÂ∫ì
            1: [
                { word: "apple", meaning: "ËãπÊûú", phonetic: "/Àà√¶pl/", example: "I like to eat an apple. ÊàëÂñúÊ¨¢ÂêÉËãπÊûú„ÄÇ" },
                { word: "book", meaning: "‰π¶", phonetic: "/b äk/", example: "This is my book. ËøôÊòØÊàëÁöÑ‰π¶„ÄÇ" }
            ]
        };

        let currentGrade = null;
        let currentWord = null;
        let score = 0;
        let currentMode = 'input';
        let revealedLetters = [];

        // ÈÄâÊã©Ê∏∏ÊàèÊ®°Âºè
        document.querySelectorAll('.mode-btn').forEach(button => {
            button.addEventListener('click', () => {
                currentMode = button.dataset.mode;
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                button.classList.add('active');
                
                if (currentMode === 'choice') {
                    document.querySelector('.options-container').style.display = 'grid';
                    document.querySelector('.input-mode-container').style.display = 'none';
                } else {
                    document.querySelector('.options-container').style.display = 'none';
                    document.querySelector('.input-mode-container').style.display = 'flex';
                }
                
                if (currentGrade) {
                    startNewGame();
                }
            });
        });

        // ÈÄâÊã©Âπ¥Á∫ß
        document.querySelectorAll('.grade-btn').forEach(button => {
            button.addEventListener('click', () => {
                currentGrade = parseInt(button.dataset.grade);
                document.querySelectorAll('.grade-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                button.classList.add('active');
                startNewGame();
            });
        });

        // ÂºÄÂßãÊñ∞Ê∏∏Êàè
        function startNewGame() {
            window.speechSynthesis.cancel(); // ÂÅúÊ≠¢ÊâÄÊúâËØ≠Èü≥
            const words = wordDatabase[currentGrade];
            currentWord = words[Math.floor(Math.random() * words.length)];
            
            document.querySelector('.word').textContent = currentWord.meaning;
            document.querySelector('.phonetic').textContent = currentWord.phonetic;
            document.querySelector('.answer-display').style.display = 'none';
            
            // Âú®‰æãÂè•‰∏≠ÂàõÂª∫Á©∫ÁôΩÔºà‰∏§ÁßçÊ®°ÂºèÈÉΩÈÄÇÁî®Ôºâ
            if (currentWord.example && currentWord.example.includes(currentWord.word)) {
                const exampleParts = currentWord.example.split(currentWord.word);
                const blankExample = `${exampleParts[0]}<span class="blank-word">_____</span>${exampleParts[1]}`;
                document.querySelector('.example').innerHTML = blankExample;
            } else {
                document.querySelector('.example').textContent = currentWord.example || '';
            }
            
            if (currentMode === 'choice') {
                // ËÆæÁΩÆÈÄâÈ°π
                const options = getRandomOptions(words, currentWord);
                document.querySelectorAll('.option-btn').forEach((btn, index) => {
                    btn.textContent = options[index].word;
                    btn.classList.remove('correct', 'wrong');
                });
            } else {
                // ËÆæÁΩÆÂ≠óÊØçÊèêÁ§∫
                setupHintLetters();
            }
            
            document.querySelector('.result').textContent = '';
            document.querySelector('.result').className = 'result';
            document.getElementById('answer-input').value = '';
        }

        // ËÆæÁΩÆÂ≠óÊØçÊèêÁ§∫
        function setupHintLetters() {
            const hintLettersContainer = document.querySelector('.hint-letters-container');
            hintLettersContainer.innerHTML = '';
            revealedLetters = [];
            
            const wordLength = currentWord.word.length;
            const lettersToReveal = Math.ceil(wordLength / 3); // ÊòæÁ§∫1/3ÁöÑÂ≠óÊØç
            
            // ÈöèÊú∫ÈÄâÊã©Ë¶ÅÊòæÁ§∫ÁöÑÂ≠óÊØç‰ΩçÁΩÆ
            while (revealedLetters.length < lettersToReveal) {
                const randomIndex = Math.floor(Math.random() * wordLength);
                if (!revealedLetters.includes(randomIndex)) {
                    revealedLetters.push(randomIndex);
                }
            }
            
            // ÂàõÂª∫Â≠óÊØçÊèêÁ§∫Ê°Ü
            for (let i = 0; i < wordLength; i++) {
                const letterBox = document.createElement('div');
                letterBox.className = 'hint-letter';
                if (revealedLetters.includes(i)) {
                    letterBox.textContent = currentWord.word[i];
                    letterBox.classList.add('revealed');
                }
                hintLettersContainer.appendChild(letterBox);
            }
        }

        // Ëé∑ÂèñÈöèÊú∫ÈÄâÈ°π
        function getRandomOptions(words, correctWord) {
            const options = [correctWord];
            while (options.length < 4) {
                const randomWord = words[Math.floor(Math.random() * words.length)];
                if (!options.includes(randomWord)) {
                    options.push(randomWord);
                }
            }
            return shuffleArray(options);
        }

        // Êâì‰π±Êï∞ÁªÑÈ°∫Â∫è
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Êèê‰∫§Á≠îÊ°àÔºàËæìÂÖ•Ê®°ÂºèÔºâ
        document.querySelector('.submit-btn').addEventListener('click', () => {
            const userAnswer = document.getElementById('answer-input').value.toLowerCase();
            checkAnswer(userAnswer);
        });

        // ÈÄâÊã©Á≠îÊ°àÔºàÈÄâÊã©È¢òÊ®°ÂºèÔºâ
        document.querySelectorAll('.option-btn').forEach(button => {
            button.addEventListener('click', () => {
                const userAnswer = button.textContent;
                checkAnswer(userAnswer);
            });
        });

        // Ê£ÄÊü•Á≠îÊ°à
        function checkAnswer(userAnswer) {
            const resultDiv = document.querySelector('.result');
            
            if (userAnswer === currentWord.word) {
                score += 10;
                resultDiv.textContent = 'ÂõûÁ≠îÊ≠£Á°ÆÔºÅ';
                resultDiv.className = 'result correct';
                document.getElementById('score').textContent = score;
                
                if (currentMode === 'choice') {
                    document.querySelectorAll('.option-btn').forEach(btn => {
                        if (btn.textContent === currentWord.word) {
                            btn.classList.add('correct');
                        }
                    });
                }
                
                // ÊòæÁ§∫ÂÆåÊï¥‰æãÂè•
                const exampleElement = document.querySelector('.example');
                const fullExample = currentWord.example;
                exampleElement.innerHTML = fullExample;
                
                setTimeout(startNewGame, 1500);
            } else {
                resultDiv.textContent = 'ÂõûÁ≠îÈîôËØØÔºåËØ∑ÈáçËØïÔºÅ';
                resultDiv.className = 'result wrong';
                
                if (currentMode === 'choice') {
                    document.querySelectorAll('.option-btn').forEach(btn => {
                        if (btn.textContent === userAnswer) {
                            btn.classList.add('wrong');
                        }
                    });
                }
            }
        }

        // ÊåâÂõûËΩ¶ÈîÆÊèê‰∫§
        document.getElementById('answer-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.querySelector('.submit-btn').click();
            }
        });

        // ÊòæÁ§∫Á≠îÊ°àÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
        document.querySelector('.show-answer-btn').addEventListener('click', () => {
            const answerDisplay = document.querySelector('.answer-display');
            answerDisplay.textContent = `Ê≠£Á°ÆÁ≠îÊ°à: ${currentWord.word}`;
            answerDisplay.style.display = 'block';
            
            // 3ÁßíÂêéËá™Âä®ÈöêËóèÁ≠îÊ°à
            setTimeout(() => {
                answerDisplay.style.display = 'none';
            }, 3000);
        });

        // Ê£ÄÊü•ÊµèËßàÂô®ÂÖºÂÆπÊÄß
        function checkBrowserCompatibility() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
            
            if (isIOS && !isSafari) {
                alert('Âª∫ËÆÆ‰ΩøÁî®SafariÊµèËßàÂô®‰ª•Ëé∑ÂæóÊúÄ‰Ω≥‰ΩìÈ™å');
            }
            
            if (!('speechSynthesis' in window)) {
                console.warn('ÂΩìÂâçÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ÂêàÊàêÂäüËÉΩ');
            }
        }

        // Âú®È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÊ£ÄÊü•ÂÖºÂÆπÊÄß
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkBrowserCompatibility, 1000);
        });

        // ËØ≠Èü≥ÂêàÊàêÂäüËÉΩ
        function speakWord(word) {
            if ('speechSynthesis' in window) {
                try {
                    // Á°Æ‰øùÂÅúÊ≠¢ÊâÄÊúâÊ≠£Âú®Êí≠ÊîæÁöÑËØ≠Èü≥
                    window.speechSynthesis.cancel();
                    
                    // Á≠âÂæÖ‰∏ÄÂ∞èÊÆµÊó∂Èó¥Á°Æ‰øùÊ∏ÖÁêÜÂÆåÊàê
                    setTimeout(() => {
                        // Ëé∑ÂèñÊâÄÊúâÂèØÁî®ÁöÑËØ≠Èü≥
                        const voices = window.speechSynthesis.getVoices();
                        const englishVoice = voices.find(voice => voice.lang.includes('en'));
                        
                        if (!englishVoice) {
                            useBackupSpeech(word);
                            return;
                        }

                        // ÂàõÂª∫Êñ∞ÁöÑËØ≠Èü≥ÂÆû‰æã
                        const utterance = new SpeechSynthesisUtterance(word);
                        
                        // ËÆæÁΩÆËØ≠Èü≥ÂèÇÊï∞
                        utterance.voice = englishVoice;
                        utterance.lang = 'en-US';
                        utterance.rate = 0.8;
                        utterance.pitch = 1.0;
                        utterance.volume = 1.0;
                        
                        // Ê∑ªÂä†ÈîôËØØÂ§ÑÁêÜ
                        utterance.onerror = function(event) {
                            console.error('ËØ≠Èü≥ÂêàÊàêÈîôËØØ:', event);
                            useBackupSpeech(word);
                        };
                        
                        // Ê∑ªÂä†ÂºÄÂßã‰∫ã‰ª∂Â§ÑÁêÜ
                        utterance.onstart = function() {
                            console.log('ÂºÄÂßãÊí≠ÊîæËØ≠Èü≥');
                        };
                        
                        // Ê∑ªÂä†ÂÆåÊàê‰∫ã‰ª∂Â§ÑÁêÜ
                        utterance.onend = function() {
                            console.log('ËØ≠Èü≥Êí≠ÊîæÂÆåÊàê');
                            // Á°Æ‰øùÊ∏ÖÁêÜËØ≠Èü≥ÂêàÊàêÂô®
                            window.speechSynthesis.cancel();
                        };
                        
                        // Êí≠ÊîæËØ≠Èü≥
                        window.speechSynthesis.speak(utterance);
                    }, 100);
                } catch (error) {
                    console.error('ËØ≠Èü≥ÂêàÊàêÂºÇÂ∏∏:', error);
                    useBackupSpeech(word);
                }
            } else {
                useBackupSpeech(word);
            }
        }

        // Â§áÁî®ËØ≠Èü≥ÂêàÊàêÊñπÊ≥ï
        function useBackupSpeech(word) {
            // ‰ΩøÁî®ÁôæÂ∫¶ËØ≠Èü≥ÂêàÊàêAPI
            const audio = new Audio();
            // ‰ΩøÁî®ÁôæÂ∫¶ÁøªËØëÁöÑËØ≠Èü≥API
            audio.src = `https://fanyi.baidu.com/gettts?lan=en&text=${encodeURIComponent(word)}&spd=3&source=web`;
            
            audio.onerror = function() {
                console.error('Â§áÁî®ËØ≠Èü≥Êí≠ÊîæÂ§±Ë¥•');
                // Â¶ÇÊûúÁôæÂ∫¶API‰πüÂ§±Ë¥•ÔºåÂ∞ùËØï‰ΩøÁî®Êú¨Âú∞ËØ≠Èü≥Êñá‰ª∂
                tryLocalAudio(word);
            };
            
            audio.play().catch(error => {
                console.error('Êí≠ÊîæÈü≥È¢ëÂ§±Ë¥•:', error);
                // Â¶ÇÊûúÊí≠ÊîæÂ§±Ë¥•ÔºåÂ∞ùËØï‰ΩøÁî®Êú¨Âú∞ËØ≠Èü≥Êñá‰ª∂
                tryLocalAudio(word);
            });
        }

        // Â∞ùËØï‰ΩøÁî®Êú¨Âú∞ËØ≠Èü≥Êñá‰ª∂
        function tryLocalAudio(word) {
            // ‰ΩøÁî®Êú¨Âú∞È¢ÑÂΩïÂà∂ÁöÑËØ≠Èü≥Êñá‰ª∂
            const audio = new Audio();
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†‰∏Ä‰∫õÂ∏∏Áî®ÂçïËØçÁöÑÊú¨Âú∞ËØ≠Èü≥Êñá‰ª∂
            const localAudioMap = {
                'apple': 'audio/apple.mp3',
                'book': 'audio/book.mp3',
                // ÂèØ‰ª•ÁªßÁª≠Ê∑ªÂä†Êõ¥Â§öÂçïËØçÁöÑËØ≠Èü≥Êñá‰ª∂
            };
            
            if (localAudioMap[word]) {
                audio.src = localAudioMap[word];
                audio.play().catch(error => {
                    console.error('Êí≠ÊîæÊú¨Âú∞Èü≥È¢ëÂ§±Ë¥•:', error);
                    alert('ËØ≠Èü≥Êí≠ÊîæÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Á≥ªÁªüÂ£∞Èü≥ËÆæÁΩÆ„ÄÇ');
                });
            } else {
                alert('ÊöÇ‰∏çÊîØÊåÅËØ•ÂçïËØçÁöÑËØ≠Èü≥Êí≠Êîæ„ÄÇ');
            }
        }

        // ‰∏∫ÂèëÈü≥ÊåâÈíÆÊ∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
        document.querySelector('.speak-btn').addEventListener('click', function() {
            // Á°Æ‰øùÂÅúÊ≠¢ÊâÄÊúâÊ≠£Âú®Êí≠ÊîæÁöÑËØ≠Èü≥
            window.speechSynthesis.cancel();
            
            const exampleElement = document.querySelector('.example');
            let exampleText = exampleElement.textContent;
            
            // Â¶ÇÊûú‰æãÂè•‰∏≠ÂåÖÂê´Á©∫ÁôΩÈÉ®ÂàÜÔºåÊõøÊç¢‰∏∫ÂÆûÈôÖÂçïËØç
            if (exampleText.includes('_____') && currentWord) {
                exampleText = exampleText.replace('_____', currentWord.word);
            }
            
            if (exampleText && exampleText !== 'undefined') {
                // Âè™Êí≠ÊîæËã±ÊñáÈÉ®ÂàÜ
                const englishPart = exampleText.split('„ÄÇ')[0].trim();
                if (englishPart) {
                    speakWord(englishPart);
                }
            }
        });

        // Ê∑ªÂä†Ëß¶Êë∏‰∫ã‰ª∂ÊîØÊåÅ
        document.addEventListener('touchstart', function(e) {
            if (e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT') {
                e.target.classList.add('active');
            }
        }, false);

        document.addEventListener('touchend', function(e) {
            if (e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT') {
                e.target.classList.remove('active');
            }
        }, false);

        // Èò≤Ê≠¢ÂèåÂáªÁº©Êîæ
        document.addEventListener('dblclick', function(e) {
            e.preventDefault();
        }, false);
    </script>
</body>
</html> 